<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="css/globals.css"/>
    <link rel="stylesheet" href="css/style.css"/>
    <link rel="stylesheet" href="css/signup.css"/>
    <script type="text/javascript" src="js/layout.js"></script>

</head>

<body>
<div class="screen">
    <div class="group">
        <div class="div">ê²Œì‹œíŒ</div>
        <a href="/login" class="text-wrapper" id="loginLink">ë¡œê·¸ì¸</a>
        <a href="/signup" class="frame" id="signupLink">
            <div class="text-wrapper-4">íšŒì›ê°€ì…</div>
        </a>
        <a href="/logout" class="frame" id="logoutLink" style="display: none">
            <div class="text-wrapper-4">ë¡œê·¸ì•„ì›ƒ</div>
        </a>
    </div>
    <div class="overlap">
        <img class="img" src="https://c.animaapp.com/TFf1ian7/img/-----2025-01-22-161402-1.png"/>
        <img class="element-2" src="https://c.animaapp.com/TFf1ian7/img/-----2025-01-22-161343-1@2x.png"/>
        <img class="element-3" src="https://c.animaapp.com/TFf1ian7/img/-----2025-01-22-161057-1@2x.png"/>
        <img class="image" src="https://c.animaapp.com/TFf1ian7/img/image4@2x.png"/>
        <img class="image-2" src="https://c.animaapp.com/TFf1ian7/img/image2@2x.png"/>
        <img class="image-3" src="https://c.animaapp.com/TFf1ian7/img/image3.png"/>
        <img class="element-4" src="https://c.animaapp.com/TFf1ian7/img/-----2025-01-22-161237-1@2x.png"/>
        <div class="signup-container">
            <h1 class="signup-title">íšŒì›ê°€ì…</h1>
            <form class="signup-form" method="post" onsubmit="handleFormSubmit(event)">
                <div class="form-group">
                    <label for="email">ì´ë©”ì¼</label>
                    <input type="email" id="email" pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]" required placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="form-group">
                    <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="password" required placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="form-group">
                    <label for="confirmPassword">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                    <input type="password" id="confirmPassword" required placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”">
                </div>
                <div class="form-group">
                    <label for="phone">íœ´ëŒ€ì „í™” ë²ˆí˜¸</label>
                    <div class="phone-wrapper">
                        <div class="country-selector">
                            <select id="country-code" required>
                                <option value="+82" data-flag="kr">ğŸ‡°ğŸ‡· +82</option>
                                <option value="+1" data-flag="us">ğŸ‡ºğŸ‡¸ +1</option>
                                <!-- ë‹¤ë¥¸ êµ­ê°€ ì˜µì…˜ ì¶”ê°€ -->
                            </select>
                            <input type="tel" id="phone" pattern="\d{3}-\d{4}-\d{4}" maxlength="13" required placeholder="010 0000 0000">
                        </div>
                    </div>
                </div>
                <div class="name-inputs">
                    <div class="form-group">
                        <label for="name">ì´ë¦„</label>
                        <input type="text" id="name" placeholder="ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”." required>
                    </div>

                    <div class="form-group">
                        <label for="nickName">ë‹‰ë„¤ì„</label>
                        <input type="text" id="nickName" placeholder="ë‹‰ë„¤ì„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”." required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="svcAgmt">
                        <input type="checkbox" id="svcAgmt" required>
                        ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜ í•˜ì‹­ë‹ˆê¹Œ?
                    </label>
                </div>
                <div class="form-group">
                    <label for="infoAgmt">
                        <input type="checkbox" id="infoAgmt" required>
                        ì„œë¹„ìŠ¤ ì´ìš©ì•½ê´€ì— ë™ì˜ í•˜ì‹­ë‹ˆê¹Œ?
                    </label>
                </div>
                <button type="submit" class="signup-button">íšŒì›ê°€ì…</button>
            </form>
        </div>
    </div>
    <div class="text-wrapper-3">ìš”ê¸ˆ ì•ˆë‚´</div>
    <a class="text-wrapper" href="/">
        <img class="element-5" src="https://c.animaapp.com/TFf1ian7/img/-----2025-01-22-165404-1@2x.png"/>
    </a>
</div>
<script type="text/javascript">
    window.onload = function() {
        // ë””ìŠ¤í”Œë ˆì´ ë°°ìœ¨ ê°’ ì–»ê¸°
        const devicePixelRatio = window.devicePixelRatio;

        // ë°°ìœ¨ì— ë”°ë¼ scale ê°’ ê³„ì‚° (ì˜ˆ: 125% ë°°ìœ¨ì€ 0.8, 100% ë°°ìœ¨ì€ 1.0)
        let scaleValue = 1.0;  // ê¸°ë³¸ ê°’ 1.0
        if (devicePixelRatio > 1) {
            scaleValue = 0.8;  // ë°°ìœ¨ì´ 100% ì´ìƒì¼ ë•Œ 0.8ë¡œ ì¶•ì†Œ
        }

        // í™”ë©´ ì¶•ì†Œ ì ìš©
        document.body.style.transform = `scale(${scaleValue})`;  // ë°°ìœ¨ì— ë§ê²Œ ì¶•ì†Œ
        document.body.style.transformOrigin = "0 0";  // ì¶•ì†Œ ê¸°ì¤€ì„ ì™¼ìª½ ìƒë‹¨ìœ¼ë¡œ ì„¤ì •

        // í™”ë©´ í¬ê¸° ì„¤ì • (1920x1080)
        document.body.style.width = "1920px";
        document.body.style.height = "1080px";

        const token = localStorage.getItem('token'); // localStorageì—ì„œ token í™•ì¸

        const loginLink = document.getElementById('loginLink');
        const signupLink = document.getElementById('signupLink');
        const logoutLink = document.getElementById('logoutLink');

        if (token) {
            // í† í°ì´ ìˆìœ¼ë©´ ë¡œê·¸ì¸/íšŒì›ê°€ì… ë§í¬ ìˆ¨ê¸°ê³  ë¡œê·¸ì•„ì›ƒ ë§í¬ ë³´ì„
            loginLink.style.display = 'none';
            signupLink.style.display = 'none';
            logoutLink.style.display = 'flex';
        } else {
            // í† í°ì´ ì—†ìœ¼ë©´ ë¡œê·¸ì¸/íšŒì›ê°€ì… ë§í¬ ë³´ì„
            loginLink.style.display = 'flex';
            signupLink.style.display = 'flex';
            logoutLink.style.display = 'none';
        }
    };
</script>
<script>
    // íœ´ëŒ€ì „í™” ë²ˆí˜¸ë¥¼ êµ­ê°€ ì½”ë“œì™€ ê²°í•©í•˜ëŠ” í•¨ìˆ˜
    function getFullPhoneNumber() {
        const countryCode = document.getElementById('country-code').value;
        const phoneNumber = document.getElementById('phone').value;
        return countryCode + phoneNumber;
    }
    document.getElementById('logoutLink').addEventListener('click', function(event) {
        // localStorageì—ì„œ token ì‚­ì œ
        localStorage.removeItem('token');
    });
    // í¼ ì œì¶œ ì²˜ë¦¬ í•¨ìˆ˜
    function handleFormSubmit(event) {
        event.preventDefault(); // í¼ ì œì¶œ ê¸°ë³¸ ë™ì‘ ë°©ì§€
        const fullPhoneNumber = getFullPhoneNumber();

        const formData = {
            email: document.getElementById('email').value,
            password: document.getElementById('password').value,
            confirmPassword: document.getElementById('confirmPassword').value,
            phone: fullPhoneNumber,
            name: document.getElementById('name').value,
            nickName: document.getElementById('nickName').value,
            svcAgmt: document.getElementById('svcAgmt').checked,
            infoAgmt: document.getElementById('infoAgmt').checked,
        };

        // fetchë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì„œë²„ë¡œ ë°ì´í„° ì „ì†¡
        fetch('/signup', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json', // ì„œë²„ê°€ JSONì„ ì²˜ë¦¬í•˜ë„ë¡
            },
            body: JSON.stringify(formData), // JSON í˜•ì‹ìœ¼ë¡œ ë°ì´í„° ì „ì†¡
        })
            .then(response => {
                if (!response.ok) {
                    return response.json().then(data => {
                        throw new Error(data.message || 'ì„œë²„ì™€ì˜ í†µì‹ ì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    });
                }
                return response.text(); // ì„±ê³µì ì¸ ì‘ë‹µì„ textë¡œ ë³€í™˜
            })
            .then(data => {
                if (data) {
                    window.location.href = '/login';
                } else {
                    alert('íšŒì›ê°€ì… ì‹¤íŒ¨');
                }
            })
            .catch(error => {
                console.error('ì—ëŸ¬ ë°œìƒ:', error);
                alert('ì„œë²„ì™€ì˜ í†µì‹ ì— ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            });
    }
</script>
</body>
</html>